device = "cuda"
use_wandb = true

[dataset]
location = "local"
task = "segmentation-human-simplified"

labels_path = "../data/human_benchmark_sig_17/pd_meshnet20_seg_benchmark/seg"

[dataset.train]
path = "../data/human_benchmark_sig_17/pd_meshnet20_seg_benchmark/train"

[dataset.test]
path = "../data/human_benchmark_sig_17/pd_meshnet20_seg_benchmark/test"

[dataset.train.kw]
transforms = ["vertex_center_scale", "rotate", "jitter"]
num_classes = 8

[dataset.train.kw.extract_kw]
mode = "bigbird"

[dataset.train.kw.extract_kw.nbor_kw]
v_max = 32
e_max = 48
f_max = 1
dilations = 1
v_k = 8
e_k = 8
f_k = 8
clip_nbors = false
modes = ["r", "l"]
percs = [0.2, 0.8]

[dataset.test.kw]
transforms = ["vertex_center_scale"]
num_classes = 8

[dataset.test.kw.extract_kw]
mode = "bigbird"

[dataset.test.kw.extract_kw.nbor_kw]
v_max = 32
e_max = 48
f_max = 1
dilations = 1
v_k = 8
e_k = 8
f_k = 8
clip_nbors = false
modes = ["r", "l"]
percs = [0.2, 0.8]

[dataset.dataloader.train]
batch_size = 8
shuffle = true
num_workers = 12
persistent_workers = true
multiprocessing_context = "forkserver"
drop_last = false

[dataset.dataloader.test]
batch_size = 12
shuffle = false
num_workers = 8
persistent_workers = true
multiprocessing_context = "forkserver"
drop_last = false

[train]

epochs = 200
lr = 5e-4

[train.model]
v_in = 7
e_in = 21
f_in = 13
d_v = 256
d_e = 256
d_f = 256
d_hidden = 512
N = 6
dropout = 0.1
modes = "v"
embed_type = "neighbor"
attn_type = "hodge"
task_type = "segmentation"
layer_layout = "6:2e"

[train.model.embed_kw]
n = 2

[train.model.attn_kw]
h = 4
dropout_attn = 0.1
attn_sym = false
attn_mask = false
norm_type = "layer_norm"
hodge_type = "grouped"
attn_acc = false

[train.model.attn_basic_kw]
h = 4
dropout_attn = 0.3
norm_type = false
attn_type = "full-linear-fast-transformers"

[train.model.task_kw]
num_classes = 8
modes = "v"
out = "f"
dropout = 0.1

[train.loss]
loss_type = "cross-entropy"
label_smoothing = 0.2
ignore_index = -1

[train.optim]
use_reg = false
reg_type = "activations"
_lambda = 1e-5

[wandb]
WANDB_MODE = "online" # Options: 'online', 'offline' ,'disabled'
name = "hodgeformer-human-simplified[wacv-reb]"

[wandb.init]
project = "meshbert"
entity = "anousias-k3y"
