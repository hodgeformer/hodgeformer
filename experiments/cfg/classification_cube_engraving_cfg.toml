device = "cuda"
use_wandb = true

[dataset]
task = "classification"
path = "../data/cube-engraving/cubes"

[dataset.train.kw]
transforms = ["vertex_center_scale", "rotate", "jitter"]
num_classes = 22

[dataset.train.kw.extract_kw]
mode = "bigbird"

[dataset.train.kw.extract_kw.nbor_kw]
v_max = 16
e_max = 32
f_max = 16
dilations = 1
v_k = 8
e_k = 8
f_k = 8
clip_nbors = false
modes = ["r", "l"]
percs = [0.2, 0.8]

[dataset.test.kw]
transforms = ["vertex_center_scale"]
num_classes = 22

[dataset.test.kw.extract_kw]
mode = "bigbird"

[dataset.test.kw.extract_kw.nbor_kw]
v_max = 16
e_max = 32
f_max = 16
dilations = 1
v_k = 8
e_k = 8
f_k = 8
clip_nbors = false
modes = ["r", "l"]
percs = [0.2, 0.8]

[dataset.dataloader.train]
batch_size = 16
shuffle = true
num_workers = 12
multiprocessing_context = "forkserver"
persistent_workers = true
drop_last = false

[dataset.dataloader.test]
batch_size = 16
shuffle = false
num_workers = 8
multiprocessing_context = "forkserver"
persistent_workers = true
drop_last = false

[train]
epochs = 300
lr = 5e-4

[train.model]
v_in = 7
e_in = 21
f_in = 13
d_v = 256
d_e = 256
d_f = 256
d_hidden = 512
N = 6
dropout = 0.1
modes = "v"
embed_type = "neighbor"
attn_type = "hodge"
task_type = "classification"
layer_layout = "2:1e"

[train.model.embed_kw]
n = 2

[train.model.attn_kw]
h = 4
dropout_attn = 0.1
attn_sym = false
attn_mask = false
norm_type = "layer_norm"
hodge_type = "grouped"
attn_acc = false

[train.model.attn_basic_kw]
h = 4
dropout_attn = 0.2
norm_type = false
attn_type = "full-linear-fast-transformers"

[train.model.task_kw]
num_classes = 22
modes = "v"
dropout = 0.1
head_type = "linear"
head_kw = { h = 4, dropout_attn = 0.1 }

[train.loss]
loss_type = "cross-entropy"
label_smoothing = 0.2

[train.optim]
use_reg = false
reg_type = "activations"
_lambda = 1e-5

[wandb]
WANDB_MODE = "online"     # Options: 'online', 'offline' ,'disabled'
name = "hodgeformer-cubes[wacv-hf]"

[wandb.init]
project = "meshbert"
entity = "anousias-k3y"
